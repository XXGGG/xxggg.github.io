---
title: 1.【折腾记录】Gitee Pages自动同步GitHub Pages的内容
author: '谢夏戈'
date: 2020-08-16
sidebar: 'auto'
categories:
 - 折腾记录

tags:
 - GitHub
---
# Gitee Pages自动同步GitHub Pages的内容
## 遇到的问题！(可以跳过不看，或看参考文章的)

因为国内无法访问到GitHub Pages的原因。   
我把GitHub仓库 同步到了 码云-Gitee  并且启用 Gitee Pages

>我想同时更新两个仓库,也就是两个博客。。。

- 之前用的方法是 一个本地仓库绑定两个远程仓库（GitHub和Gitee）  

但由于我GitHub Pages的主分支是用 副分支采用GitHub的Actions自动部署的  
（简单说就是，我GitHub只push副分支，所以Gitee也只push副分支，而GitHub的Actions有帮我打包更新到master主分支，而Gitee码云没有更新master主分支）

这就导致我xxggg.github.io这个博客有更新，而xxggg.gitee.io这个博客没有更新。

解决方法有很多。  
**一：在我的Gitee项目里按一下强制同步那个按钮（但是这。。。）**  
**二：不用主副分支，分两个仓库，一个源代码，一个打包后的代码。（但是这样每次都要手动打包 还要push两次）**
**三：也就是今天要讲的！👇 用GitHub Actions把代码同步到Gitee**

>主要参考文章：  
https://www.imooc.com/article/302662  
https://github.com/marketplace/actions/gitee-pages-action

## 主要操作

在项目根目录下创建 .github/workflows/ 在这个文件夹里再创建sync.yml文件 （ GitHub 的Actions会处理.github下的工作流文件夹<code>workflows</code> )
```yml
name: Sync

on: [ psuh ]

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
        - name: Sync to Gitee
            uses: wearerequired/git-mirror-action@master
            env:
                # 注意在 Settings->Secrets 配置 GITEE_RSA_PRIVATE_KEY
                SSH_PRIVATE_KEY: ${{ secrets.GITEE_RSA_PRIVATE_KEY }}
            with:
                # 注意替换为你的 GitHub 源仓库地址
                source-repo: "git@github.com:XXGGG/xxggg.github.io.git"
                # 注意替换为你的 Gitee 目标仓库地址
                destination-repo: "git@gitee.com:XXGGG/XXGGG.git"

        - name: Build Gitee Pages
            uses: yanglbme/gitee-pages-action@master
            with:
                # 注意替换为你的 Gitee 用户名
                gitee-username: XXGGG
                # 注意在 Settings->Secrets 配置 GITEE_PASSWORD
                gitee-password: ${{ secrets.GITEE_PASSWORD }}
                # 注意替换为你的 Gitee 仓库
                gitee-repo: XXGGG/XXGGG
```
这里面最重要的除了简单更换填写你的github跟gitee对应项目地址以外  
最重要的的就是配置好你GitHub项目里的<code>settings</code>-><code>secrets</code> 里的<code>GITEE_RSA_PRIVATE_KEY</code> 和 <code>GITEE_PASSWORD</code>

- <code>GITEE_RSA_PRIVATE_KEY</code> 是你的私钥
- <code>GITEE_PASSWORD</code> 是你Gitee的账户密码

## 如何得到私钥公钥

>参考文章：
https://blog.csdn.net/fenghuibian/article/details/73350890
https://gitee.com/help/articles/4181#article-header0

### 第一步 生成SSH Key
打开终端 或者是Git Bash (windows下载git后自带的)
    
    ssh-keygen -t rsa -C "xxxx@xxxx.com"
    //(xxxx@xxxx.com 为你的邮箱)

按照提示完成三次回车，即可生成 ssh key。  
通过查看 ~/.ssh/id_rsa.pub 文件内容，获取到你的公钥

    cat ~/.ssh/id_rsa.pub

然后出来的一大串东西都是公钥。

### 第二步 把公钥添加到github 和 gitee
去浏览器登上你的GitHub然后在<code>settings</code>-><code>SSH and GPG keys</code>里添加上公钥（码云gitee同理）

### 第三步 测试是否配置成功 ssh -T git@github.com

打开终端，测试github用

    ssh -T git@github.com

测试itee用

    ssh -T git@gitee.com

若返回 Hi XXX! You've successfully authenticated, but (Gitee.com/GitHub.com) does not provide shell access. 内容，则证明添加成功。

## 填上刚刚需要的私钥

在 ~/.ssh目录下有id_rsa 和id_rsa.pub两个文件  
id_rsa.pub是公钥  
id_rsa 是私钥

    cat ~/.ssh/id_rsa

查看私钥 然后把私钥添加到GitHub项目里的<code>settings</code>-><code>secrets</code> 里的<code>GITEE_RSA_PRIVATE_KEY</code>
>注意 全都要复制 别漏了 开头和结尾也要复制进去

## 最后

这就可以啦 每次push都会把GitHub的整个仓库（包括分支的内容） 强制同步到Gitee上 

对于Gitee Pages前提是你已经开启Gitee Pages哦 首次同步要去开一下Gitee Pages（当然前提是你是准备搞博客或者是别的项目）

如果你只是单纯想同步到Gitee 那还不如一个仓库地址绑定两个远程仓库呢

### 最最后
欢迎大家来看我的blog（前端萌新一只）  
[xxggg.github.io](https://xxggg.github.io)  
[xxggg.gitee.io](https://xxggg.gitee.io)   

**(文中如果出了什么问题欢迎反馈)**













---
title: 2.【折腾记录】删除之前commit的提交
author: '谢夏戈'
date: 2020-08-16
sidebar: 'auto'
categories:
 - 折腾记录

tags:
 - Git
---

# 删除之前commit的提交

>真是一波未平 一波又起呀！

如果你之前push提交的时候，文件夹里面有泄露隐私的东西，就算你现在把文件删除重新push覆盖   
一样可以从GitHub的历史日志中找到这个文件。 就hin不安全。。。   
     

- 而办法除了删除这个仓库，重新换一个仓库。  
- 还有一个办法就删除对应commit的提交日志。


>或者你要修改/删除之前写错的commit  

所以！！！ 综合了广大人民的智慧结晶！  
我！  
整理了以下资料！（我自己的实操）  

##  git rebase

没错 像我这样的小白 用git最多的就是  
<code>git add .</code>  
<code>git commit -m 'xx'</code>  
<code>git push</code>   
<code>git pull</code>

<code>git rebase</code> 是什么 没听过， 但是字面上的意思 貌似是“重定基础”?


首先 在终端或者vs code编辑器里的终端👇   

    git rebase -i <你要删除的那个commit的前一个的id>
    // 注意 是'前一个' 以它为基础

>这个历史日志id可以在GitHub的项目里面找到  
>也可以<code>git log</code>打开看到。**退出git log 是按 'Q'**   
可以简写 - 只写前7位

然后它会进入一个类似vim的界面（说实话 我还没用过vim）

    pick 9d3ea6c test3
    pick 4b33d2a test4
    pick 6a9f5ff ???
    pick 2a42ccc git手册
    pick 8461cdd 删除日志

不知道啥代号 | 历史日志id |  commit的信息 
> 类似上面👆这样

然后我们根据它里面的提示 去修改前面的这个pick  

那问题就来了 怎么修改??!! 像我没有用过vim的童鞋来说  
google了一下  然鹅! 我就在这里总结起来  

就是按'i' 对 你可以用英文输入法 或者开启大写来按 'i"  
进入所谓的'insert模式' （他会显示什么<-插入->）

然后方向键到pick 这里 把 pick改成drop👇

    pick 9d3ea6c test3
    drop 4b33d2a test4
    pick 6a9f5ff ???
    pick 2a42ccc git手册
    pick 8461cdd 删除日志

或者根据它下面的提示简写成 d 也是可以的

    pick 9d3ea6c test3
    d 4b33d2a test4
    pick 6a9f5ff ???
    pick 2a42ccc git手册
    pick 8461cdd 删除日志


**然后按 "ESC" 退出到命令行以后**  
**在命令行直接输入<code>:wq</code>**  
w代表保存 q代表退出。(当然还有其他的,可以自行查阅)  
注意 输入的时候要前面的 " : "也是要输入的。(我就是直接在查的时候,别人没有说明 我就只输入了 wq 然后一直不行)。(没办法我没用过vim 不是怪人家 嘟嘟嘴~#3#)

这样我们本地仓库的历史日志就修改好了,不过可能需要处理一下合并的问题
所以我这里没有直接用<code>drop</code>  我是根据提示用了<code>fixup</code> 就是合并前一个commit 并且删除此历史日志 也就是


    pick 9d3ea6c test3
    f 3b33d2a test4
    pick 6a9f5ff ???
    pick 2a42ccc git手册
    pick 8461cdd 删除日志

>👆这样的操作

那就不用处理合并的问题了   
test4的内容会合并到test3 而test4这个commit会消失  

## 最后 
我们可以本地 git log 看一下本地的仓库历史日志 。(**退出git log 是按 'Q'**)  
然后push上我们的github  

这里push也是有技巧的  

需要<code>git push -f</code>  
就是 - 强推


可能它还需要你选一下分支 因为它还存在rebase中  

    git push origin <你分支的名字> --force

如果还在rebase中 貌似要退出一下
    
    git rebase --abort
    
或者
    
    git rebase --skip
    
或者
    
    git rebase --continue
    
戳一下就出来了 en！o(￣▽￣)ｄ 

## 最后的最后
感谢您看到这里 希望能帮到您  
文中如果出现什么错误，请见谅（我是小白，就记录一下自己的折腾过程）。并反馈给我 #3#

我的GitHub：[谢夏戈-XXGGG](https://github.com/XXGGG)  
我的博客：[谢夏戈的博客（GitHubPages）](https://github.com/XXGGG) ，[谢夏戈的博客（GiteePages）](https://xxggg.gitee.io/) 


---
参考文章： 
[https://blog.csdn.net/qq_37960603/article/details/82814939?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param](https://blog.csdn.net/qq_37960603/article/details/82814939?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param)
  
[https://www.jianshu.com/p/384a945f6e7e](https://www.jianshu.com/p/384a945f6e7e)

[https://blog.csdn.net/faithmy509/article/details/81271436?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param](https://blog.csdn.net/faithmy509/article/details/81271436?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param)
