(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{517:function(e,s,t){"use strict";t.r(s);var n=t(4),r=Object(n.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"遇到的问题🐷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题🐷"}},[e._v("#")]),e._v(" 遇到的问题🐷")]),e._v(" "),t("p",[e._v("在回顾之前作品demo时发现，我在监听鼠标的时候，即使退出了“当前页面”也没有消除监听。"),t("br"),e._v("\n发现原因是我退出了“当前页面”后，还在控制台看到了“console.log”的输出")]),e._v(" "),t("p",[e._v("后面使用了vue中的"),t("code",[e._v("destroyed")]),e._v("生命周期函数来在“这个页面组件销毁时”配合"),t("code",[e._v("window.removeEventListener('mousemove',this.move)")]),e._v("来销毁监听。")]),e._v(" "),t("p",[e._v("但是还是没用，查阅后有人说要在后面加上“true”。"),t("br"),e._v("\n比如👉"),t("code",[e._v("window.removeEventListener('mousemove',this.move，true)")]),t("br"),e._v(" "),t("strong",[e._v("还是没用")]),t("br"),e._v("\n其实后面这个“true” 是用来调整“捕获/冒泡”事件的"),t("br"),e._v(" "),t("a",{attrs:{href:"https://blog.csdn.net/learn8more/article/details/103193872",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考文章"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"解决方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[e._v("#")]),e._v(" 解决方法")]),e._v(" "),t("p",[e._v("问题其实出现在👇"),t("br"),e._v("\n我在主组件APP.vue中使用了")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("<keep-alive>\n    <router-view></router-view>\n</keep-alive>\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("导致页面缓存了，所以组件并没有被销毁，也就是说，没有触发"),t("code",[e._v("destroyed")]),t("br"),e._v("\n所以我们需要手动触发"),t("br"),e._v("\n👇就是当路由发现变化时，调用"),t("code",[e._v("destroy")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("beforeRouteLeave(to, from, next) {\n    this.$destroy();\n    next();\n},\ndestroyed() {\n    window.removeEventListener('mousemove',this.move)\n    console.log('销毁成功')\n}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("hr"),e._v(" "),t("p",[e._v("还有一个原因:我在监听和销毁时 所指定的那个方法。"),t("br"),e._v("\n比如👇")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("window.addEventListener('mousemove',(e)=>this.move(e))\n和\nwindow.removeEventListener('mousemove',(e)=>this.move(e))\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("这样是不行的，因为他们指定的不算是同一个方法，也就是说，我们不能使用这样传参的方式！")]),e._v(" "),t("p",[e._v("但是监听就是为了得到参数，不过根据试验，可以使用下面这样的方式👇")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("window.addEventListener('mousemove',this.move)\n和\nwindow.removeEventListener('mousemove',this.move)\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("也就是说 不用传参，在"),t("code",[e._v("methods")]),e._v("中的"),t("code",[e._v("move(e)")]),e._v("直接就可以拿到参数"),t("code",[e._v("e")]),e._v("了"),t("br"),e._v("\n而且也不要使用匿名函数。")]),e._v(" "),t("p",[e._v("这样就可以销毁监听了。")]),e._v(" "),t("h2",{attrs:{id:"总结👇"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结👇"}},[e._v("#")]),e._v(" 总结👇")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("用路由跳转的监听方式来探测组件被关闭，然后调用相应的“销毁监听方法”（由于我使用了keep-alive）【如果没有使用，是会直接调用vue的生命周期函数的】")])]),e._v(" "),t("li",[t("p",[e._v("在销毁监听时，不要直接传参也不要使用匿名函数。监听后得到数据会直接作用在后面的方法中。")])])]),e._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[e._v("#")]),e._v(" 参考文章")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://cloud.tencent.com/developer/ask/147772",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考文章1"),t("OutboundLink")],1),t("br"),e._v(" "),t("a",{attrs:{href:"https://www.cnblogs.com/spqin/p/13186950.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考文章2"),t("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);